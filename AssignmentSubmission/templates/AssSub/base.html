{% load static tailwind_tags %}
<!DOCTYPE html>
<html lang="en">

<head>
  <title>Django Tailwind</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="manifest" href="{% static 'manifest.json' %}">
<meta name="theme-color" content="#1e40af">
  {% tailwind_css %}
</head>

<body class="font-nunito">
  <div class="lg:mx-8 mx-auto">
    <div class="flex flex-col items-center justify-center h-screen">
      <div class="mx-4 md:p-8" id="register-content">
    
        <div class="card base-100 shadow-lg w-80 rounded-lg bg-white">
          <form
          id="register-form-1"
            method="post"
            hx-post="{% url 'check-id' %}"
            hx-swap="outerHTML"
            hx-trigger="submit delay:2000ms"
            hx-target="#register-content"
            class="space-y-4">
            {% csrf_token %}
            <div class="card-body">
              
            <p class="text-3xl text-center mb-8">Registration</p>
                {% if form_error %}
                <div role="alert" class="alert alert-error alert-soft">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0 stroke-current" fill="none" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                  <span>{{ form_error }}</span>
                </div>
                {% endif %}
            
            <div class="my-4">
              <label for="student_id" class="floating-label">
                <span>Student ID</span>
                <input type="text" id="student_id" name="student_id" class="input" placeholder="24254XXXXX" required>
              </label>
            </div>
            
            <div class="mb-4">
              <button type="submit" class="btn btn-primary w-full" onclick="showSpinner(event)">
                <span id="btnText">Continue</span>
                <span class="loading loading-spinner" id="spinner" style="display: none;"></span>
              </button>
            </div>
            </div>            
          </form>
        </div>

      </div>
    </div>
  </div>
</body>
<script>
  
  function showPassword() {
    const passwordInput = document.getElementById('password');
    const eyeIcon = document.querySelector('.swap input[type="checkbox"]');
    
    if (eyeIcon.checked) {
      passwordInput.type = 'text'; // Show password
    } else {
      passwordInput.type = 'password'; // Hide password
    }
  }

  function showSpinner(event) {
    const form = event.target.closest('form');
    const spinner = document.getElementById('spinner');
    const btnText = document.getElementById('btnText');
    spinner.style.display = 'block';
    btnText.style.display = 'none'; // Hide the button text
    
  }

</script>
<script>
    document.addEventListener("DOMContentLoaded", () => {
      const form = document.getElementById("otp-form");
      const inputs = [...form.querySelectorAll("input[type=text]")];

      const handleKeyDown = (e) => {
        if (
          !/^[0-9]{1}$/.test(e.key) &&
          e.key !== "Backspace" &&
          e.key !== "Delete" &&
          e.key !== "Tab" &&
          !e.metaKey
        ) {
          e.preventDefault();
        }

        if (e.key === "Delete" || e.key === "Backspace") {
          const index = inputs.indexOf(e.target);
          if (index > 0) {
            inputs[index - 1].value = "";
            inputs[index - 1].focus();
          }
        }
      };

      const handleInput = (e) => {
        const { target } = e;
        const index = inputs.indexOf(target);
        if (target.value) {
          if (index < inputs.length - 1) {
            inputs[index + 1].focus();
          }
        }
      };

      const handleFocus = (e) => {
        e.target.select();
      };

      const handlePaste = (e) => {
        e.preventDefault();
        const text = e.clipboardData.getData("text");
        if (!new RegExp(`^[0-9]{${inputs.length}}$`).test(text)) {
          return;
        }
        const digits = text.split("");
        inputs.forEach((input, index) => (input.value = digits[index]));
      };

      inputs.forEach((input) => {
        input.addEventListener("input", handleInput);
        input.addEventListener("keydown", handleKeyDown);
        input.addEventListener("focus", handleFocus);
        input.addEventListener("paste", handlePaste);
      });
    });
  </script>
 <script src="https://cdn.jsdelivr.net/npm/htmx.org@2.0.6/dist/htmx.min.js"></script>
</html>
